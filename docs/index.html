<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>遊具管理システム | 点検チェックシートページ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/destyle.css@1.0.15/destyle.css"/>
<link rel="stylesheet" href="static/CSS/style.css">
<style>
    .ai-predicted { background-color: #e3f2fd !important; font-weight: bold; }
    .grade-A { color: #4caf50; }
    .grade-B { color: #ff9800; }
    .grade-C { color: #f44336; }
    .confidence-info { font-size: 0.8em; color: #666; }
</style>
</head>
<body>
<header class="header">
    <div class="flexbox">
        <h1><a href="/">遊具管理システム</a></h1>
        <div class="account_toggle" id="mobile">
            <img src="static/img/Icon.svg" alt="アカウント" id="accountIcon">
        </div>
        <button><img src="static/img/bell.png" alt="通知"></button>
        <div class="nav_wrapper">
            <input type="checkbox" id="nav_toggle" hidden>
            <label class="nav_icon" for="nav_toggle">
                <span></span>
                <span></span>
                <span></span>
            </label>
            <div class="overlay"></div>
            <nav class="nav">
                <ul>
                    <li><a href="/">トップページ</a></li>
                    <li><a href="/daily_report">日報作成</a></li>
                    <li><a href="/results_report">結果報告書作成</a></li>
                    <li><a href="/CheckSheet">点検チェックシート</a></li>
                    <li><a href="/Deterioration">劣化進行・劣化予測</a></li>
                    <li><a href="/PhotoViewing">写真閲覧</a></li>
                    <li><a href="/AllDocuments">書類一覧</a></li>         
                </ul>
            </nav>
        </div>
    </div>
</header>

<div class="wrapper">
<p id="page_route"><a href="/">トップ</a> > <a href="/CheckSheet">点検チェックシート</a></p>

<!-- 検索フォーム -->
<div class="section">
    <div class="CheckSheet_input_area AllDocuments_search_section">
        <label for="search_park">公園名</label><br>
        <input type="search" id="search_park" name="search_park" placeholder="キーワードを入力"><br>
        
        <label for="search_author">作成者名</label><br>
        <input type="search" id="search_author" name="search_author" placeholder="キーワードを入力"><br>
        
        <div class="CheckSheet_search_year">
            <label for="inspection_year">点検年度</label><br>
            <select id="inspection_year" name="inspection_year">
                <option value="all" selected>すべて</option>
                <option value="2025">令和７年度</option>
                <option value="2024">令和６年度</option>
                <option value="2023">令和５年度</option>
            </select>
        </div>
        <br>
        
        <div class="CheckSheet_search_wrapper">
            <div class="CheckSheet_search_year">
                <label for="install_era">設置年度</label><br>
                <select id="install_era" name="install_era">
                    <option value="reiwa" selected>令和</option>
                    <option value="heisei">平成</option>
                </select>
            </div>
            <div class="CheckSheet_search_year">
                <label for="install_year_num">　</label><br>
                <select id="install_year_num" name="install_year_num">
                    <option value="1">１年度</option>
                    <option value="2">２年度</option>
                    <option value="3">３年度</option>
                    <option value="4">４年度</option>
                    <option value="5">５年度</option>
                    <option value="6">６年度</option>
                    <option value="7">７年度</option>
                    <option value="8">８年度</option>
                    <option value="9">９年度</option>
                </select>
            </div>
        </div>
        
        <label for="inspection_date">点検日</label><br>
        <input type="date" id="inspection_date" name="inspection_date">
    </div>
</div>

<!-- 点検チェックシート -->
<div class="section check_area">
<h1>点検時の記録</h1>

<table class="CheckSheet_list">
<thead>
<tr>
<th rowspan="2">点検部位</th>
<th rowspan="2">項目</th>
<th colspan="3">結果</th>
<th rowspan="2">写真</th>
</tr>
<tr>
<th>A<br>異常なし</th>
<th>B<br>経過観察</th>
<th>C<br>要対応</th>
</tr>
</thead>
<tbody>

<!-- ここから点検部位ごとに完全展開 -->

<!-- 柱・梁(本体) -->
<tr><td>柱・梁(本体)</td><td>ぐらつき</td><td><input type="radio" name="柱・梁_1" value="A"></td><td><input type="radio" name="柱・梁_1" value="B"></td><td><input type="radio" name="柱・梁_1" value="C"></td><td><button type="button" onclick="takePhoto('柱・梁(本体)','ぐらつき')">📷</button></td></tr>
<tr><td>柱・梁(本体)</td><td>破損</td><td><input type="radio" name="柱・梁_2" value="A"></td><td><input type="radio" name="柱・梁_2" value="B"></td><td><input type="radio" name="柱・梁_2" value="C"></td><td><button type="button" onclick="takePhoto('柱・梁(本体)','破損')">📷</button></td></tr>
<tr><td>柱・梁(本体)</td><td>変形</td><td><input type="radio" name="柱・梁_3" value="A"></td><td><input type="radio" name="柱・梁_3" value="B"></td><td><input type="radio" name="柱・梁_3" value="C"></td><td><button type="button" onclick="takePhoto('柱・梁(本体)','変形')">📷</button></td></tr>
<tr><td>柱・梁(本体)</td><td>腐食(腐朽)</td><td><input type="radio" name="柱・梁_4" value="A"></td><td><input type="radio" name="柱・梁_4" value="B"></td><td><input type="radio" name="柱・梁_4" value="C"></td><td><button type="button" onclick="takePhoto('柱・梁(本体)','腐食(腐朽)')">📷</button></td></tr>
<tr><td>柱・梁(本体)</td><td>接合部の緩み</td><td><input type="radio" name="柱・梁_5" value="A"></td><td><input type="radio" name="柱・梁_5" value="B"></td><td><input type="radio" name="柱・梁_5" value="C"></td><td><button type="button" onclick="takePhoto('柱・梁(本体)','接合部の緩み')">📷</button></td></tr>

<!-- 接合部(継ぎ手) -->
<tr><td>接合部(継ぎ手)</td><td>破損</td><td><input type="radio" name="接合部_1" value="A"></td><td><input type="radio" name="接合部_1" value="B"></td><td><input type="radio" name="接合部_1" value="C"></td><td><button type="button" onclick="takePhoto('接合部(継ぎ手)','破損')">📷</button></td></tr>
<tr><td>接合部(継ぎ手)</td><td>変形</td><td><input type="radio" name="接合部_2" value="A"></td><td><input type="radio" name="接合部_2" value="B"></td><td><input type="radio" name="接合部_2" value="C"></td><td><button type="button" onclick="takePhoto('接合部(継ぎ手)','変形')">📷</button></td></tr>
<tr><td>接合部(継ぎ手)</td><td>腐食</td><td><input type="radio" name="接合部_3" value="A"></td><td><input type="radio" name="接合部_3" value="B"></td><td><input type="radio" name="接合部_3" value="C"></td><td><button type="button" onclick="takePhoto('接合部(継ぎ手)','腐食')">📷</button></td></tr>
<tr><td>接合部(継ぎ手)</td><td>ボルトの緩み</td><td><input type="radio" name="接合部_4" value="A"></td><td><input type="radio" name="接合部_4" value="B"></td><td><input type="radio" name="接合部_4" value="C"></td><td><button type="button" onclick="takePhoto('接合部(継ぎ手)','ボルトの緩み')">📷</button></td></tr>
<tr><td>接合部(継ぎ手)</td><td>欠落</td><td><input type="radio" name="接合部_5" value="A"></td><td><input type="radio" name="接合部_5" value="B"></td><td><input type="radio" name="接合部_5" value="C"></td><td><button type="button" onclick="takePhoto('接合部(継ぎ手)','欠落')">📷</button></td></tr>

<!-- 吊金具 -->
<tr><td>吊金具</td><td>破損</td><td><input type="radio" name="吊金具_1" value="A"></td><td><input type="radio" name="吊金具_1" value="B"></td><td><input type="radio" name="吊金具_1" value="C"></td><td><button type="button" onclick="takePhoto('吊金具','破損')">📷</button></td></tr>
<tr><td>吊金具</td><td>変形</td><td><input type="radio" name="吊金具_2" value="A"></td><td><input type="radio" name="吊金具_2" value="B"></td><td><input type="radio" name="吊金具_2" value="C"></td><td><button type="button" onclick="takePhoto('吊金具','変形')">📷</button></td></tr>
<tr><td>吊金具</td><td>腐食</td><td><input type="radio" name="吊金具_3" value="A"></td><td><input type="radio" name="吊金具_3" value="B"></td><td><input type="radio" name="吊金具_3" value="C"></td><td><button type="button" onclick="takePhoto('吊金具','腐食')">📷</button></td></tr>
<tr><td>吊金具</td><td>異音</td><td><input type="radio" name="吊金具_4" value="A"></td><td><input type="radio" name="吊金具_4" value="B"></td><td><input type="radio" name="吊金具_4" value="C"></td><td><button type="button" onclick="takePhoto('吊金具','異音')">📷</button></td></tr>
<tr><td>吊金具</td><td>金具本体のずれ</td><td><input type="radio" name="吊金具_5" value="A"></td><td><input type="radio" name="吊金具_5" value="B"></td><td><input type="radio" name="吊金具_5" value="C"></td><td><button type="button" onclick="takePhoto('吊金具','金具本体のずれ')">📷</button></td></tr>
<tr><td>吊金具</td><td>摩耗</td><td><input type="radio" name="吊金具_6" value="A"></td><td><input type="radio" name="吊金具_6" value="B"></td><td><input type="radio" name="吊金具_6" value="C"></td><td><button type="button" onclick="takePhoto('吊金具','摩耗')">📷</button></td></tr>
<tr><td>吊金具</td><td>ボルトの緩み</td><td><input type="radio" name="吊金具_7" value="A"></td><td><input type="radio" name="吊金具_7" value="B"></td><td><input type="radio" name="吊金具_7" value="C"></td><td><button type="button" onclick="takePhoto('吊金具','ボルトの緩み')">📷</button></td></tr>
<tr><td>吊金具</td><td>欠落</td><td><input type="radio" name="吊金具_8" value="A"></td><td><input type="radio" name="吊金具_8" value="B"></td><td><input type="radio" name="吊金具_8" value="C"></td><td><button type="button" onclick="takePhoto('吊金具','欠落')">📷</button></td></tr>

<!-- 揺動部（チェーン・ロープ） -->
<tr><td>揺動部（チェーン・ロープ）</td><td>ねじれ</td><td><input type="radio" name="チェーン_1" value="A"></td><td><input type="radio" name="チェーン_1" value="B"></td><td><input type="radio" name="チェーン_1" value="C"></td><td><button type="button" onclick="takePhoto('揺動部（チェーン・ロープ）','ねじれ')">📷</button></td></tr>
<tr><td>揺動部（チェーン・ロープ）</td><td>変形</td><td><input type="radio" name="チェーン_2" value="A"></td><td><input type="radio" name="チェーン_2" value="B"></td><td><input type="radio" name="チェーン_2" value="C"></td><td><button type="button" onclick="takePhoto('揺動部（チェーン・ロープ）','変形')">📷</button></td></tr>
<tr><td>揺動部（チェーン・ロープ）</td><td>破損</td><td><input type="radio" name="チェーン_3" value="A"></td><td><input type="radio" name="チェーン_3" value="B"></td><td><input type="radio" name="チェーン_3" value="C"></td><td><button type="button" onclick="takePhoto('揺動部（チェーン・ロープ）','破損')">📷</button></td></tr>
<tr><td>揺動部（チェーン・ロープ）</td><td>ほつれ</td><td><input type="radio" name="チェーン_4" value="A"></td><td><input type="radio" name="チェーン_4" value="B"></td><td><input type="radio" name="チェーン_4" value="C"></td><td><button type="button" onclick="takePhoto('揺動部（チェーン・ロープ）','ほつれ')">📷</button></td></tr>
<tr><td>揺動部（チェーン・ロープ）</td><td>断線</td><td><input type="radio" name="チェーン_5" value="A"></td><td><input type="radio" name="チェーン_5" value="B"></td><td><input type="radio" name="チェーン_5" value="C"></td><td><button type="button" onclick="takePhoto('揺動部（チェーン・ロープ）','断線')">📷</button></td></tr>
<tr><td>揺動部（チェーン・ロープ）</td><td>摩耗(× :1/3以上、1/2以上は使用禁止)</td><td><input type="radio" name="チェーン_6" value="A"></td><td><input type="radio" name="チェーン_6" value="B"></td><td><input type="radio" name="チェーン_6" value="C"></td><td><button type="button" onclick="takePhoto('揺動部（チェーン・ロープ）','摩耗')">📷</button></td></tr>

<!-- 揺動部（座板・座面(タイヤ)） -->
<tr><td>揺動部（座板・座面(タイヤ)）</td><td>ヒビ</td><td><input type="radio" name="座板_1" value="A"></td><td><input type="radio" name="座板_1" value="B"></td><td><input type="radio" name="座板_1" value="C"></td><td><button type="button" onclick="takePhoto('揺動部（座板・座面(タイヤ)）','ヒビ')">📷</button></td></tr>
<tr><td>揺動部（座板・座面(タイヤ)）</td><td>割れ</td><td><input type="radio" name="座板_2" value="A"></td><td><input type="radio" name="座板_2" value="B"></td><td><input type="radio" name="座板_2" value="C"></td><td><button type="button" onclick="takePhoto('揺動部（座板・座面(タイヤ)）','割れ')">📷</button></td></tr>
<tr><td>揺動部（座板・座面(タイヤ)）</td><td>湾曲等変形</td><td><input type="radio" name="座板_3" value="A"></td><td><input type="radio" name="座板_3" value="B"></td><td><input type="radio" name="座板_3" value="C"></td><td><button type="button" onclick="takePhoto('揺動部（座板・座面(タイヤ)）','湾曲等変形')">📷</button></td></tr>
<tr><td>揺動部（座板・座面(タイヤ)）</td><td>破損</td><td><input type="radio" name="座板_4" value="A"></td><td><input type="radio" name="座板_4" value="B"></td><td><input type="radio" name="座板_4" value="C"></td><td><button type="button" onclick="takePhoto('揺動部（座板・座面(タイヤ)）','破損')">📷</button></td></tr>
<tr><td>揺動部（座板・座面(タイヤ)）</td><td>腐朽</td><td><input type="radio" name="座板_5" value="A"></td><td><input type="radio" name="座板_5" value="B"></td><td><input type="radio" name="座板_5" value="C"></td><td><button type="button" onclick="takePhoto('揺動部（座板・座面(タイヤ)）','腐朽')">📷</button></td></tr>
<tr><td>揺動部（座板・座面(タイヤ)）</td><td>金具の摩耗(× ：1/3以上、1/2以上は使用禁止)</td><td><input type="radio" name="座板_6" value="A"></td><td><input type="radio" name="座板_6" value="B"></td><td><input type="radio" name="座板_6" value="C"></td><td><button type="button" onclick="takePhoto('揺動部（座板・座面(タイヤ)）','金具の摩耗')">📷</button></td></tr>
<tr><td>揺動部（座板・座面(タイヤ)）</td><td>ボルト、袋ナットの緩み</td><td><input type="radio" name="座板_7" value="A"></td><td><input type="radio" name="座板_7" value="B"></td><td><input type="radio" name="座板_7" value="C"></td><td><button type="button" onclick="takePhoto('揺動部（座板・座面(タイヤ)）','ボルト、袋ナットの緩み')">📷</button></td></tr>
<tr><td>揺動部（座板・座面(タイヤ)）</td><td>破損、腐食、欠落</td><td><input type="radio" name="座板_8" value="A"></td><td><input type="radio" name="座板_8" value="B"></td><td><input type="radio" name="座板_8" value="C"></td><td><button type="button" onclick="takePhoto('揺動部（座板・座面(タイヤ)）','破損、腐食、欠落')">📷</button></td></tr>

<!-- 安全柵 -->
<tr><td>安全柵</td><td>ぐらつき</td><td><input type="radio" name="安全柵_1" value="A"></td><td><input type="radio" name="安全柵_1" value="B"></td><td><input type="radio" name="安全柵_1" value="C"></td><td><button type="button" onclick="takePhoto('安全柵','ぐらつき')">📷</button></td></tr>
<tr><td>安全柵</td><td>破損</td><td><input type="radio" name="安全柵_2" value="A"></td><td><input type="radio" name="安全柵_2" value="B"></td><td><input type="radio" name="安全柵_2" value="C"></td><td><button type="button" onclick="takePhoto('安全柵','破損')">📷</button></td></tr>
<tr><td>安全柵</td><td>変形</td><td><input type="radio" name="安全柵_3" value="A"></td><td><input type="radio" name="安全柵_3" value="B"></td><td><input type="radio" name="安全柵_3" value="C"></td><td><button type="button" onclick="takePhoto('安全柵','変形')">📷</button></td></tr>
<tr><td>安全柵</td><td>腐食</td><td><input type="radio" name="安全柵_4" value="A"></td><td><input type="radio" name="安全柵_4" value="B"></td><td><input type="radio" name="安全柵_4" value="C"></td><td><button type="button" onclick="takePhoto('安全柵','腐食')">📷</button></td></tr>
<tr><td>安全柵</td><td>〔接合部・ボルト〕緩み</td><td><input type="radio" name="安全柵_5" value="A"></td><td><input type="radio" name="安全柵_5" value="B"></td><td><input type="radio" name="安全柵_5" value="C"></td><td><button type="button" onclick="takePhoto('安全柵','〔接合部・ボルト〕緩み')">📷</button></td></tr>
<tr><td>安全柵</td><td>欠落</td><td><input type="radio" name="安全柵_6" value="A"></td><td><input type="radio" name="安全柵_6" value="B"></td><td><input type="radio" name="安全柵_6" value="C"></td><td><button type="button" onclick="takePhoto('安全柵','欠落')">📷</button></td></tr>

<!-- その他 -->
<tr><td>その他</td><td>異物</td><td><input type="radio" name="その他_1" value="A"></td><td><input type="radio" name="その他_1" value="B"></td><td><input type="radio" name="その他_1" value="C"></td><td><button type="button" onclick="takePhoto('その他','異物')">📷</button></td></tr>
<tr><td>その他</td><td>落書き</td><td><input type="radio" name="その他_2" value="A"></td><td><input type="radio" name="その他_2" value="B"></td><td><input type="radio" name="その他_2" value="C"></td><td><button type="button" onclick="takePhoto('その他','落書き')">📷</button></td></tr>

<!-- 基礎 -->
<tr><td>基礎</td><td>基礎が露出</td><td><input type="radio" name="基礎_1" value="A"></td><td><input type="radio" name="基礎_1" value="B"></td><td><input type="radio" name="基礎_1" value="C"></td><td><button type="button" onclick="takePhoto('基礎','基礎が露出')">📷</button></td></tr>
<tr><td>基礎</td><td>亀裂</td><td><input type="radio" name="基礎_2" value="A"></td><td><input type="radio" name="基礎_2" value="B"></td><td><input type="radio" name="基礎_2" value="C"></td><td><button type="button" onclick="takePhoto('基礎','亀裂')">📷</button></td></tr>
<tr><td>基礎</td><td>破損</td><td><input type="radio" name="基礎_3" value="A"></td><td><input type="radio" name="基礎_3" value="B"></td><td><input type="radio" name="基礎_3" value="C"></td><td><button type="button" onclick="takePhoto('基礎','破損')">📷</button></td></tr>

<!-- 地表部・安全柵内 -->
<tr><td>地表部・安全柵内</td><td>大きな凹凸</td><td><input type="radio" name="地表_1" value="A"></td><td><input type="radio" name="地表_1" value="B"></td><td><input type="radio" name="地表_1" value="C"></td><td><button type="button" onclick="takePhoto('地表部・安全柵内','大きな凹凸')">📷</button></td></tr>
<tr><td>地表部・安全柵内</td><td>石や根の露出</td><td><input type="radio" name="地表_2" value="A"></td><td><input type="radio" name="地表_2" value="B"></td><td><input type="radio" name="地表_2" value="C"></td><td><button type="button" onclick="takePhoto('地表部・安全柵内','石や根の露出')">📷</button></td></tr>
<tr><td>地表部・安全柵内</td><td>異物</td><td><input type="radio" name="地表_3" value="A"></td><td><input type="radio" name="地表_3" value="B"></td><td><input type="radio" name="地表_3" value="C"></td><td><button type="button" onclick="takePhoto('地表部・安全柵内','異物')">📷</button></td></tr>
<tr><td>地表部・安全柵内</td><td>マットのめくれ</td><td><input type="radio" name="地表_4" value="A"></td><td><input type="radio" name="地表_4" value="B"></td><td><input type="radio" name="地表_4" value="C"></td><td><button type="button" onclick="takePhoto('地表部・安全柵内','マットのめくれ')">📷</button></td></tr>
<tr><td>地表部・安全柵内</td><td>破損</td><td><input type="radio" name="地表_5" value="A"></td><td><input type="radio" name="地表_5" value="B"></td><td><input type="radio" name="地表_5" value="C"></td><td><button type="button" onclick="takePhoto('地表部・安全柵内','破損')">📷</button></td></tr>
<tr><td>地表部・安全柵内</td><td>樹木の枝</td><td><input type="radio" name="地表_6" value="A"></td><td><input type="radio" name="地表_6" value="B"></td><td><input type="radio" name="地表_6" value="C"></td><td><button type="button" onclick="takePhoto('地表部・安全柵内','樹木の枝')">📷</button></td></tr>
>

</tbody>
</table>

<h2>措置及び総合結果</h2>
<div class="CheckSheet_save_button">
<button type="button" onclick="saveSheet()">保存</button>
</div>

</div>

<script>
function takePhoto(part, item){
    alert(`写真撮影: ${part} - ${item}`);
}

async function saveSheet(){
    const formData = new FormData(document.querySelector('.wrapper'));
    const data = {};
    formData.forEach((value,key) => {
        data[key] = value;
    });

    const response = await fetch('/api/save_sheet', {
        method:'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
    });

    if(response.ok){
        const blob = await response.blob();
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'inspection_result.xlsx';
        a.click();
        URL.revokeObjectURL(url);
    } else {
        alert('保存に失敗しました');
    }
}
</script>
</body>
</html>
