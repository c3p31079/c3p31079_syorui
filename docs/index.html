<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>遊具管理システム | 点検チェックシートページ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/destyle.css@1.0.15/destyle.css"/>
    <link rel="stylesheet" href="./CSS/style.css">
    <style>
        .ai-predicted { background-color: #e3f2fd !important; font-weight: bold; }
        .grade-A { color: #4caf50; }
        .grade-B { color: #ff9800; }
        .grade-C { color: #f44336; }
        .confidence-info { font-size: 0.8em; color: #666; }
    </style>
</head>
<body>
<header class="header">
    <div class="flexbox">
        <h1><a href="{{ url_for('home') }}">遊具管理システム</a></h1>
        <div class="account_toggle" id="mobile">
            <img src="./img/Icon.svg">
        </div>
        <button><img src="./img/bell.png"></button>
        <div class="nav_wrapper">
            <input type="checkbox" id="nav_toggle" hidden>
            <label class="nav_icon" for="nav_toggle">
                <span></span>
                <span></span>
                <span></span>
            </label>
            <div class="overlay"></div>
            <nav class="nav">
                <ul>
                    <li><a href="{{ url_for('home') }}">トップページ</a></li>
                    <li><a href="{{ url_for('daily_report') }}">日報作成</a></li>
                    <li><a href="{{ url_for('results_report') }}">結果報告書作成</a></li>
                    <li><a href="{{ url_for('CheckSheet') }}">点検チェックシート</a></li>
                    <li><a href="{{ url_for('Deterioration') }}">劣化進行・劣化予測</a></li>
                    <li><a href="{{ url_for('PhotoViewing') }}">写真閲覧</a></li>
                    <li><a href="{{ url_for('AllDocuments') }}">書類一覧</a></li>         
                </ul>
            </nav>
        </div>
    </div>
</header>

<div class="wrapper">
    <p id="page_route"><a href="{{ url_for('home') }}">トップ</a> > <a href="{{ url_for('CheckSheet') }}">点検チェックシート</a></p>

    <!-- ========================================
         検索フォーム
         ======================================== -->
    <div class="section">
        <div class="CheckSheet_input_area AllDocuments_search_section">
            <label for="search_park">公園名</label><br>
            <input type="search" id="search_park" name="search_park" placeholder="キーワードを入力"><br>
            
            <label for="search_author">作成者名</label><br>
            <input type="search" id="search_author" name="search_author" placeholder="キーワードを入力"><br>
            
            <label for="inspection_year">点検年度</label><br>
            <select id="inspection_year" name="inspection_year">
                <option value="all" selected>すべて</option>
                <option value="2025">令和７年度</option>
                <option value="2024">令和６年度</option>
                <option value="2023">令和５年度</option>
            </select><br>

            <label for="install_era">設置年度</label><br>
            <select id="install_era" name="install_era">
                <option value="reiwa" selected>令和</option>
                <option value="heisei">平成</option>
            </select>
            <select id="install_year_num" name="install_year_num">
                <option value="1">１年度</option>
                <option value="2">２年度</option>
                <option value="3">３年度</option>
                <option value="4">４年度</option>
                <option value="5">５年度</option>
                <option value="6">６年度</option>
                <option value="7">７年度</option>
                <option value="8">８年度</option>
                <option value="9">９年度</option>
                <option value="10">１０年度</option>
                <option value="11">１１年度</option>
                <option value="12">１２年度</option>
                <option value="13">１３年度</option>
                <option value="14">１４年度</option>
                <option value="15">１５年度</option>
                <option value="16">１６年度</option>
                <option value="17">１７年度</option>
                <option value="18">１８年度</option>
                <option value="19">１９年度</option>
                <option value="20">２０年度</option>
                <option value="21">２１年度</option>
                <option value="22">２２年度</option>
                <option value="23">２３年度</option>
                <option value="24">２４年度</option>
                <option value="25">２５年度</option>
                <option value="26">２６年度</option>
                <option value="27">２７年度</option>
                <option value="28">２８年度</option>
                <option value="29">２９年度</option>
                <option value="30">３０年度</option>
                <option value="31">３１年度</option>
            </select><br>

            <label for="inspection_date">点検日</label><br>
            <input type="date" id="inspection_date" name="inspection_date">
        </div>
    </div>

    <!-- ========================================
         点検チェックシート
         ======================================== -->
    <div class="section check_area">
        <h1>点検時の記録</h1>
        <form id="checksheet_form">
            <table class="CheckSheet_list">
    <thead>
        <tr>
            <th rowspan="2">点検部位</th>
            <th rowspan="2">項目</th>
            <th colspan="3">結果</th>
            <th rowspan="2">写真</th>
        </tr>
        <tr>
            <th>A<br>異常なし</th>
            <th>B<br>経過観察</th>
            <th>C<br>要対応</th>
        </tr>
    </thead>

    <tbody>

                <!-- ================= 柱・梁（本体） ================= -->
                 <tr>
                    <td rowspan="5">柱・梁（本体）</td>
                    <td>ぐらつき</td>
                    
                    <td class="judge-td">
                    <label>
                        <input type="radio" name="pillar_wobble" value="A" checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
                    
                    <td class="judge-td">
                    <label>
                        <input type="radio" name="pillar_wobble" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>

                    <td class="judge-td">
                    <label>
                        <input type="radio" name="pillar_wobble" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>

                    <td></td>
                </tr>
                <tr>
                    <td>破損</td>
                    
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="pillar_damage" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
                    
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="pillar_damage" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
                    
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="pillar_damage" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
                    
                    <td></td>

                </tr>
                <tr>
                    <td>変形</td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="pillar_deform" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="pillar_deform" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="pillar_deform" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
                    <td></td>

                </tr>
                <tr>
                    <td>腐食（腐朽）</td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="pillar_corrosion" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="pillar_corrosion" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="pillar_corrosion" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
                    <td></td>

                </tr>
                <tr>
                    <td>〔接合部・ボルト〕緩み</td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="pillar_joint_loose" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="pillar_joint_loose" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="pillar_joint_loose" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
                    <td></td>

                </tr>

                <!-- ================= 接合部（継ぎ手） ================= -->
                <tr>
                    <td rowspan="5">接合部（継ぎ手）</td>
                    <td>破損</td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="joint_damage" value="A" data-mark="○" checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="joint_damage" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="joint_damage" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
                    <td></td>

                </tr>
                <tr>
                    <td>変形</td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="joint_deform" value="A"   checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="joint_deform" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="joint_deform" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
                    <td></td>

                </tr>
                <tr>
                    <td>腐食</td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="joint_corrosion" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="joint_corrosion" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="joint_corrosion" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
                    <td></td>

                </tr>
                <tr>
                    <td>ボルトの緩み</td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="joint_bolt_loose" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="joint_bolt_loose" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="joint_bolt_loose" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
                    <td></td>

                </tr>
                <tr>
                    <td>欠落</td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="joint_missing" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="joint_missing" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="joint_missing" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
                    <td></td>
                </tr>

                <!-- ================= 吊金具 ================= -->
        <tr>
            <td rowspan="8">吊金具</td>
            <td>破損</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_damage" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_damage" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_damage" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>変形</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_deform" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_deform" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_deform" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>腐食</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_corrosion" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_corrosion" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_corrosion" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>異音</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_noise" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_noise" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_noise" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>金具本体のずれ</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_shift" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_shift" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_shift" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>摩耗（×：1/3以上）</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_wear_13" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_wear_13" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_wear_13" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>摩耗（×：1/2以上 ※使用禁止）</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_wear_12" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_wear_12" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_wear_12" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>ボルトの緩み／欠落</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_bolt" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_bolt" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="hanger_bolt" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>

        <!-- ================= 揺動部（チェーン・ロープ） ================= -->
        <tr>
            <td rowspan="7">揺動部（チェーン・ロープ）</td>
            <td>ねじれ</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="chain_twist" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="chain_twist" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="chain_twist" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>変形</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="chain_deform" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="chain_deform" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="chain_deform" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>破損</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="chain_damage" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="chain_damage" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="chain_damage" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>ほつれ</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="chain_fray" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="chain_fray" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="chain_fray" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>断線</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="chain_break" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="chain_break" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="chain_break" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>摩耗（×：1/3以上）</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="chain_wear_13" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="chain_wear_13" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="chain_wear_13" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>摩耗（×：1/2以上 ※使用禁止）</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="chain_wear_12" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="chain_wear_12" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="chain_wear_12" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>

        <!-- ================= 揺動部（座板・座面） ================= -->
        <tr>
            <td rowspan="10">揺動部（座板・座面）</td>
            <td>ヒビ</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_crack" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_crack" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_crack" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>割れ</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_break" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_break" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_break" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>湾曲等変形</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_deform" value="A"   checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_deform" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_deform" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>破損</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_damage" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_damage" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_damage" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>腐朽</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_rot" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_rot" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_rot" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>金具の摩耗（×：1/3以上）</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_metal_13" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_metal_13" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_metal_13" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>金具の摩耗（×：1/2以上 ※使用禁止）</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_metal_12" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_metal_12" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_metal_12" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>ボルトの緩み</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_bolt" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_bolt" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_bolt" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>袋ナットの緩み</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_nut" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_nut" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_nut" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>欠落</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_missing" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_missing" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="seat_missing" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>

        <!-- ================= 安全柵 ================= -->
        <tr>
            <td rowspan="6">安全柵</td>
            <td>ぐらつき</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="fence_wobble" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="fence_wobble" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="fence_wobble" value="C" value="C">
                        <span class="mark">△</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>破損</td>
                <td class="judge-td">
                <label>
                    <input type="radio" name="fence_damage" value="A"  checked>
                    <span class="mark">〇</span>
                </label>
                </td>
                
                <td class="judge-td">
                <label>
                    <input type="radio" name="fence_damage" value="B" >
                    <span class="mark">△</span>
                </label>
                </td>
                
                <td class="judge-td">
                <label>
                    <input type="radio" name="fence_damage" value="C">
                    <span class="mark">×</span>
                </label>
                </td>
            <td></td>
             
        </tr>
        <tr>
            <td>変形</td>
                <td class="judge-td">
                <label>
                    <input type="radio" name="fence_deform" value="A"  checked>
                    <span class="mark">〇</span>
                </label>
                </td>
                
                    <td class="judge-td">
                <label>
                    <input type="radio" name="fence_deform" value="B" >
                    <span class="mark">△</span>
                </label>
                </td>
            
                    <td class="judge-td">
                <label>
                    <input type="radio" name="fence_deform" value="C">
                    <span class="mark">×</span>
                </label>
                </td>
            <td></td>
             
        </tr>
        <tr>
            <td>腐食</td>
                <td class="judge-td">
                <label>
                    <input type="radio" name="fence_corrosion" value="A"  checked>
                    <span class="mark">〇</span>
                </label>
                </td>
                
                <td class="judge-td">
                <label>
                    <input type="radio" name="fence_corrosion" value="B" >
                    <span class="mark">△</span>
                </label>
                </td>
                
                <td class="judge-td">
                <label>
                    <input type="radio" name="fence_corrosion" value="C">
                    <span class="mark">×</span>
                </label>
                </td>
            <td></td>
             
        </tr>
        <tr>
            <td>〔接合部・ボルト〕緩み</td>
                <td class="judge-td">
                <label>
                    <input type="radio" name="fence_loose" value="A"  checked>
                    <span class="mark">〇</span>
                </label>
                </td>
              
                <td class="judge-td">
                <label>
                    <input type="radio" name="fence_loose" value="B" >
                    <span class="mark">△</span>
                </label>
                </td>
                
                <td class="judge-td">
                <label>
                    <input type="radio" name="fence_loose" value="C" value="C">
                    <span class="mark">△</span>
                </label>
                </td>
            <td></td>
             
        </tr>
        <tr>
            <td>欠落</td>
                    <td class="judge-td">
                    <label>
                        <input type="radio" name="fence_missing" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
                    
                    <td class="judge-td">
                    <label>
                        <input type="radio" name="fence_missing" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
                    
                    <td class="judge-td">
                    <label>
                        <input type="radio" name="fence_missing" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>


                                    
                <!-- ===== その他 ===== -->
                <tr>
                    <td rowspan="2">その他</td>
                    <td>異物</td>
                    
                    <td class="judge-td">
                    <label>
                        <input type="radio" name="other_sharp" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
                    
                    <td class="judge-td">
                    <label>
                        <input type="radio" name="other_sharp" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
                    
                    <td class="judge-td">
                    <label>
                        <input type="radio" name="other_sharp" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
                    <td></td>

                </tr>
                <tr>
                    <td>落書き</td>
                    
                    <td class="judge-td">
                    <label>
                        <input type="radio" name="other_sign" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
                    
                    <td class="judge-td">
                    <label>
                        <input type="radio" name="other_sign" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
                    
                    <td class="judge-td">
                    <label>
                        <input type="radio" name="other_sign" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
                    <td></td>

                </tr>


                <!-- ===== 基礎 ===== -->
                <tr>
                    <td rowspan="3">基礎</td>
                    <td>基礎の露出</td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="base_sink" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
                    
                    <td class="judge-td">
                    <label>
                        <input type="radio" name="base_sink" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
                    
                    <td class="judge-td">
                    <label>
                        <input type="radio" name="base_sink" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
                    <td></td>

                </tr>
                <tr>
                    <td>亀裂</td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="base_crack" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
                    
                    <td class="judge-td">
                    <label>
                        <input type="radio" name="base_crack" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>
                    
                    <td class="judge-td">
                    <label>
                        <input type="radio" name="base_crack" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
                    <td></td>

                </tr>
                <tr>
                    <td>破損</td>
                      <td class="judge-td">
                    <label>
                        <input type="radio" name="base_expose" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>
                    
                    <td class="judge-td">
                    <label>
                        <input type="radio" name="base_expose" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>

                    <td class="judge-td">
                    <label>
                        <input type="radio" name="base_expose" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
                    <td></td>
                </tr>


                <!-- ================= 地表部・安全柵内 ================= -->
        <tr>
            <td rowspan="6">地表部・安全柵内</td>
            <td>大きな凹凸</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="ground_uneven" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>

              <td class="judge-td">
                    <label>
                        <input type="radio" name="ground_uneven" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>

              <td class="judge-td">
                    <label>
                        <input type="radio" name="ground_uneven" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>石や根の露出</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="ground_root" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>

              <td class="judge-td">
                    <label>
                        <input type="radio" name="ground_root" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>

              <td class="judge-td">
                    <label>
                        <input type="radio" name="ground_root" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>異物</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="ground_object" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>

              <td class="judge-td">
                    <label>
                        <input type="radio" name="ground_object" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>

              <td class="judge-td">
                    <label>
                        <input type="radio" name="ground_object" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>マットのめくれ</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="ground_mat_peel" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>

              <td class="judge-td">
                    <label>
                        <input type="radio" name="ground_mat_peel" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>

              <td class="judge-td">
                    <label>
                        <input type="radio" name="ground_mat_peel" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>マットの破損</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="ground_mat_damage" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>

              <td class="judge-td">
                    <label>
                        <input type="radio" name="ground_mat_damage" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>

              <td class="judge-td">
                    <label>
                        <input type="radio" name="ground_mat_damage" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>
        <tr>
            <td>樹木の枝</td>
              <td class="judge-td">
                    <label>
                        <input type="radio" name="ground_tree" value="A"  checked>
                        <span class="mark">〇</span>
                    </label>
                    </td>

              <td class="judge-td">
                    <label>
                        <input type="radio" name="ground_tree" value="B" >
                        <span class="mark">△</span>
                    </label>
                    </td>

            <td class="judge-td">
                    <label>
                        <input type="radio" name="ground_tree" value="C">
                        <span class="mark">×</span>
                    </label>
                    </td>
            <td></td>
             
        </tr>

            </tbody>
        </table>

            <!-- ========================================
                 措置・総合結果・対応方針
                 ======================================== -->
            <div class="CheckSheet_measure_area">
                <h1>措置及び総合結果</h1>
                <h2>●点検時に実施した措置</h2>
                <input type="checkbox" id="action_grease" name="action_grease" value="grease">
                <label for="action_grease">グリース・オイル等の注入</label><br>

                <input type="checkbox" id="action_bolt" name="action_bolt" value="bolt">
                <label for="action_bolt">ボルト・ナットの増し締め・交換</label><br>

                <input type="checkbox" id="action_hanger" name="action_hanger" value="hanger">
                <label for="action_hanger">吊金具の交換</label>
                <input type="number" id="hanger_count" name="hanger_count" min="0"> 箇所<br>

                <input type="checkbox" id="action_chain" name="action_chain" value="chain">
                <label for="action_chain">チェーンの交換</label>
                <input type="number" id="chain_count" name="chain_count" min="0"> 箇所<br>

                <input type="checkbox" id="action_seat" name="action_seat" value="seat">
                <label for="action_seat">座板の交換</label>
                <input type="number" id="seat_count" name="seat_count" min="0"> 箇所<br>

                <input type="checkbox" id="action_removal" name="action_removal" value="removal">
                <label for="action_removal">石・異物の除去、枝の剪定</label><br>

                <input type="checkbox" id="action_other" name="action_other" value="other">
                <label for="action_other">その他</label>
                <input type="text" id="action_other_detail" name="action_other_detail" class="result_short_opinion"><br>

                <label for="observations">●所見</label><br>
                <textarea id="observations" name="observations" class="result_long_opinion"></textarea>

                <h2>●総合結果</h2>
                <input type="radio" id="overall_a" name="overall_result" value="A">
                <label for="overall_a">Ａ：健全（△・×なし）</label><br>
                <input type="radio" id="overall_b" name="overall_result" value="B">
                <label for="overall_b">Ｂ：経過観察（△あり、×なし）</label><br>
                <input type="radio" id="overall_c" name="overall_result" value="C">
                <label for="overall_c">Ｃ：要修繕・要対応（×あり）</label><br>
                <input type="radio" id="overall_d" name="overall_result" value="D">
                <label for="overall_d">Ｄ：使用禁止措置</label>
                <input type="text" id="overall_d_detail" name="overall_d_detail" class="result_short_opinion"><br>

                <h2>●対応方針</h2>
                <input type="checkbox" id="plan_maintenance" name="plan_maintenance" value="maintenance">
                <label for="plan_maintenance">整備班で対応予定</label><br>
                <input type="checkbox" id="plan_repair" name="plan_repair" value="repair">
                <label for="plan_repair">修繕・修繕工事で対応予定</label><br>
                <input type="checkbox" id="plan_improvement" name="plan_improvement" value="improvement">
                <label for="plan_improvement">施設改良工事で対応予定</label><br>
                <input type="checkbox" id="plan_precision" name="plan_precision" value="precision">
                <label for="plan_precision">精密点検予定</label><br>
                <input type="checkbox" id="plan_removal" name="plan_removal" value="removal">
                <label for="plan_removal">撤去予定</label><br>
                <input type="checkbox" id="plan_other" name="plan_other" value="other">
                <label for="plan_other">その他</label>
                <input type="text" id="plan_other_detail" name="plan_other_detail" class="result_short_opinion"><br>

                <h2>●対応予定時期</h2>
                <select id="response_month" name="response_month">
                    <option value="1">１月</option>
                    <option value="2">２月</option>
                    <option value="3">３月</option>
                    <option value="4">４月</option>
                    <option value="5">５月</option>
                    <option value="6">６月</option>
                    <option value="7">７月</option>
                    <option value="8">８月</option>
                    <option value="9">９月</option>
                    <option value="10">１０月</option>
                    <option value="11">１１月</option>
                    <option value="12">１２月</option>
                </select>
                <input type="radio" id="period_early" name="period" value="early"><label for="period_early">上旬</label>
                <input type="radio" id="period_mid" name="period" value="mid"><label for="period_mid">中旬</label>
                <input type="radio" id="period_late" name="period" value="late"><label for="period_late">下旬</label><br><br>

                <input type="checkbox" id="prohibition_measure" name="prohibition_measure" value="prohibition">
                <label for="prohibition_measure">本格的な使用禁止措置</label><br>
                <label for="prohibition_date">実施日</label>
                <input type="date" id="prohibition_date" name="prohibition_date"><br>
                <input type="radio" id="prohibition_done" name="prohibition_status" value="done"><label for="prohibition_done">実施済み</label>
                <input type="radio" id="prohibition_planned" name="prohibition_status" value="planned"><label for="prohibition_planned">実施予定</label><br><br>

                <label for="remarks">●備考</label><br>
                <textarea id="remarks" name="remarks" class="result_long_opinion"></textarea><br>

                <div class="CheckSheet_save_button">
                    <button type="button" id="save_excel">Excelでダウンロード</button>
                </div>
            </div>
        </div>

        <script>
        document.addEventListener("DOMContentLoaded", function() {
            const saveBtn = document.querySelector(".CheckSheet_save_button button");

            saveBtn.addEventListener("click", async (e) => {
                e.preventDefault(); // ← これを追加したよ。
                e.stopPropagation();// ← これを追加したよ。

                console.log("💾 Excelダウンロード処理開始");

                // 公園名・点検年度・設置年度
                const parkName = document.getElementById("search_park").value;
                const inspectionYear = document.getElementById("inspection_year").value;
                const installYearNum = document.getElementById("install_year_num").value;

                // 各点検部位・項目
                const parts = [
                    {part:"柱・梁（本体）", cell:"D6"},
                    {part:"接合部（継ぎ手）", cell:"D7"},
                    {part:"吊金具", cell:"D8"},
                    {part:"揺動部（チェーン・ロープ）", cell:"D9"},
                    {part:"揺動部（座板・座面）", cell:"D11"},
                    {part:"安全柵", cell:"D12"},
                    {part:"その他", cell:"D13"},
                    {part:"基礎", cell:"D14"},
                    {part:"地表部・安全柵内", cell:"D15"}
                ];

                let items = [];

                // 点検部位のチェック（仮にラジオ・チェック・テキストをここでまとめる）
                parts.forEach(p => {
                    // ラジオの例
                    ["A","B","C"].forEach(grade=>{
                        const radio = document.getElementById(`${p.part}_${grade}`);
                        if(radio && radio.checked){
                            items.push({type:"check", cell:p.cell, x_offset:0, y_offset:0});
                        }
                    });
                });

                // 措置
                const actionCheckboxes = [
                    {id:"action_grease", cell:"F6", type:"check"},
                    {id:"action_bolt", cell:"F7", type:"check"},
                    {id:"action_hanger", cell:"F8", type:"check", num_id:"hanger_count"},
                    {id:"action_chain", cell:"F9", type:"check", num_id:"chain_count"},
                    {id:"action_seat", cell:"F10", type:"check", num_id:"seat_count"},
                    {id:"action_removal", cell:"F11", type:"check"},
                    {id:"action_other", cell:"F12", type:"check", text_id:"action_other_detail"}
                ];

                actionCheckboxes.forEach(a=>{
                    const cb = document.getElementById(a.id);
                    if(cb && cb.checked){
                        items.push({type:"check", cell:a.cell, x_offset:0, y_offset:0});
                        // 数値・テキスト挿入
                        if(a.num_id){
                            const val = document.getElementById(a.num_id).value;
                            if(val) items.push({type:"text", cell:a.cell, text:`(${val}箇所)`, x_offset:1, y_offset:0});
                        }
                        if(a.text_id){
                            const val = document.getElementById(a.text_id).value;
                            if(val) items.push({type:"text", cell:a.cell, text:`(${val})`, x_offset:1, y_offset:0});
                        }
                    }
                });

                // 総合結果
                const overallRadios = ["overall_a","overall_b","overall_c","overall_d"];
                overallRadios.forEach(id=>{
                    const radio = document.getElementById(id);
                    if(radio && radio.checked){
                        const cell = "F13"; // 仮座標
                        items.push({type:"check", cell:cell});
                        if(id==="overall_d"){
                            const val = document.getElementById("overall_d_detail").value;
                            if(val) items.push({type:"text", cell:cell, text:`(${val})`, x_offset:1, y_offset:0});
                        }
                    }
                });

                // 対応方針
                const planCheckboxes = [
                    {id:"plan_maintenance", cell:"H6"},
                    {id:"plan_repair", cell:"H7"},
                    {id:"plan_improvement", cell:"H8"},
                    {id:"plan_precision", cell:"H9"},
                    {id:"plan_removal", cell:"H10"},
                    {id:"plan_other", cell:"H11", text_id:"plan_other_detail"}
                ];

                planCheckboxes.forEach(p=>{
                    const cb = document.getElementById(p.id);
                    if(cb && cb.checked){
                        items.push({type:"check", cell:p.cell, x_offset:0, y_offset:0});
                        if(p.text_id){
                            const val = document.getElementById(p.text_id).value;
                            if(val) items.push({type:"text", cell:p.cell, text:`(${val})`, x_offset:1, y_offset:0});
                        }
                    }
                });

                // 対応予定時期（月・上中下）
                const month = document.getElementById("response_month").value;
                const periodRadios = ["period_early","period_mid","period_late"];
                const periodMap = {period_early:"上旬", period_mid:"中旬", period_late:"下旬"};
                const cell = "H12"; // 仮座標
                items.push({type:"text", cell:cell, text:`${month}月`, x_offset:0, y_offset:0});
                periodRadios.forEach(id=>{
                    const radio = document.getElementById(id);
                    if(radio && radio.checked){
                        items.push({type:"circle", cell:cell, x_offset:1, y_offset:0});
                    }
                });

                // 本格的使用禁止
                const prohibition_cb = document.getElementById("prohibition_measure");
                const prohibition_cell = "H13";
                if(prohibition_cb && prohibition_cb.checked){
                    items.push({type:"check", cell:prohibition_cell});
                }
                const prohibition_date = document.getElementById("prohibition_date").value;
                if(prohibition_date){
                    items.push({type:"text", cell:prohibition_cell, text:prohibition_date, x_offset:1, y_offset:0});
                }
                const prohibition_status = ["prohibition_done","prohibition_planned"];
                prohibition_status.forEach(id=>{
                    const radio = document.getElementById(id);
                    if(radio && radio.checked){
                        items.push({type:"circle", cell:prohibition_cell, x_offset:2, y_offset:0});
                    }
                });

                // 備考
                const remarks = document.getElementById("remarks").value;
                if(remarks) items.push({type:"text", cell:"H14", text:remarks, x_offset:0, y_offset:0});

                // JSONで送信
                const payload = {
                    search_park: parkName,
                    inspection_year: inspectionYear,
                    install_year_num: installYearNum,
                    items: items
                };

                console.log("📤 送信データ:", payload);

                try{
                    const res = await fetch("http://127.0.0.1:5000/api/generate_excel", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(payload)
                    });
                    if(!res.ok) throw new Error("Excel生成失敗");
                    const blob = await res.blob();
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement("a");
                    a.href = url;
                    a.download = "点検チェックシート.xlsx";
                    document.body.appendChild(a);
                    a.click();
                    a.remove();
                    window.URL.revokeObjectURL(url);
                    console.log("✅ Excelダウンロード完了");
                }catch(err){
                    console.error(err);
                    alert("Excel生成に失敗しました");
                }
            });
        });

        document.addEventListener("DOMContentLoaded", () => {

            document.querySelectorAll("input[type='radio']").forEach(radio => {

                radio.addEventListener("change", () => {
                    const row = radio.closest("tr");

                    if(!row) return;

                    // 行内のすべてのマークをリセット
                    row.querySelectorAll(".mark").forEach(m => {
                        m.style.visibility = "hidden";
                    });

                    // 選択された列だけ表示
                    const mark = radio.closest("label").querySelector(".mark");
                    if (mark) {
                        mark.style.visibility = "visible";
                    }
                });

            });

            // 初期表示（A）
            document.querySelectorAll("tr").forEach(row => {
                const checked = row.querySelector("input[type='radio']:checked");
                if(!checked) return;
                
                const mark = checked.closest("label")?.querySelector(".mark");
                if (mark) mark.style.visibility = "visible";
            });

        });

        </script>

    </body>
</html>
